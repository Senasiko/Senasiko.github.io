<html><head><title>标题</title><link href="/static/css/app.css" rel="stylesheet"/><link href="/static/css/react.main.css" rel="stylesheet"/><link href="/static/css/markdown.css" rel="stylesheet"/><link href="/static/css/main.css" rel="stylesheet"/><script src="/static/js/jquery-3.3.1.min.js"></script><script src="/static/js/router.js"></script><script src="/static/js/react.main.js"></script><script src="/static/js/vue.manifest.js"></script><script src="/static/js/vue.vendor.js"></script><script src="/static/js/vue.app.js"></script><script type="text/javascript">$(document).ready(function() {
  var list = window.vueCom.postList('#app', {
    mounted: function() {
      list.getRef().init([{"config":{"layout":"post","title":"react redux reselect 更新机制验证","description":"react redux reselect 更新机制验证","share":true,"tags":["react","redux","reselect","vue","observer"],"date":"2018-01-29"},"content":"<p>react 本身更新数组和对象，类似于 array.push() 时，是否重新渲染组件呢？ <br/>react + redux 呢？  <br/>react + redux + reselect 呢？   </p>\n\n<h2>react</h2>\n\n<h3>更新 state</h3>\n\n<p>因 <code>react component</code> 更新状态的方式为 <code>this.setState()</code>, 所以每次都会重新渲染，不过不改变引用的情况下，新老状态值会保持一致\n<code></code>`javascript\n  class Parent extends Component {\n    constructor() {\n      super();\n      this.state = {\n        toDoListObj: {\n          toDoList: []\n        }\n      }\n    }\n    shouldComponentUpdate(nextProps, nextState) {\n      console.log(this.state.toDoListObj === nextState.toDoListObj);\n    }\n    componentWillUpdate() {\n      console.log(&#39;parent component will update&#39;);\n    }\n    addToDoList() {\n      const { toDoListObj } = this.state;\n      toDoListObj.toDoList.push(&#39;1&#39;);\n      console.log(&#39;addToDoList&#39;, toDoListObj);\n      this.setState({\n        toDoListObj\n      })\n    }\n    render() {\n      console.log(&#39;parent component render&#39;);\n      return (\n        &lt;div &gt;\n          &lt;h3&gt; Parent &lt;/h3&gt;\n          &lt;button\n            onClick={this.addToDoList.bind(this)}\n          &gt;add&lt;/button&gt;\n          &lt;div&gt;\n            {\n              this.state.toDoListObj.toDoList.map(\n                item =&gt; (\n                  &lt;span&gt;item&lt;/span&gt;\n                )\n              )\n            }\n          &lt;/div&gt;\n        &lt;/div&gt;\n      );\n    }\n  }</p>\n\n<p>  export default Parent;</p>\n\n<p><code></code>`\n&lt;div  align=&quot;center&quot;&gt;  <br/>  &lt;img src=&quot;../images/react-update/react-update-state.png&quot; alt=&quot;react-update-state&quot;&gt;\n&lt;/div&gt;</p>\n\n<h3>prop 更新</h3>\n\n<p>当 <code>children component</code> 为 <code>PureComponent</code> 时，父组件状态修改但不更改引用，父组件重新渲染，子组件会执行 <code>componentWillReceiveProps</code> 但不会重新渲染，但是这个时候 <code>setState({state: newState})</code> 会重新渲染。\n<code></code>`javascript\n  import React, { PureComponent } from &#39;react&#39;;</p>\n\n<p>  class Children extends PureComponent {\n    constructor(props) {\n      super(props);\n      this.state = {\n        toDoList: this.props.toDoList\n      }\n    }\n    componentWillReceiveProps(nextProps) {\n      console.log(&#39;children component will receive props&#39;,\n      this.props.toDoList === nextProps.toDoList);\n      this.setState({\n        toDoList: nextProps.toDoList\n      })\n    }\n    render() {\n      console.log(&#39;children component render&#39;, this.props);\n      return (\n        &lt;div &gt;\n          &lt;h3&gt; Children &lt;/h3&gt;\n          &lt;div&gt;\n            {\n              this.state.toDoList.map(\n                (item, index) =&gt; (\n                  &lt;span key={index}&gt;{ item }&lt;/span&gt;\n                )\n              )\n            }\n          &lt;/div&gt;\n        &lt;/div&gt;\n      );\n    }\n  }</p>\n\n<p>  export default Children;\n<code></code>` <br/>&lt;div  align=&quot;center&quot;&gt;  <br/>  &lt;img src=&quot;../images/react-update/prop-update.png&quot; alt=&quot;prop-update&quot;&gt;\n&lt;/div&gt;</p>\n\n<h2>react + redux</h2>\n\n<p>redux 状态更新之后，会执行所有的 <code>mapStateToProps</code>，然后浅比较更新前后的 <code>props</code> 是否一致， 如果一致，那么就不更新组件( <code>componentWillReceiveProps</code> 也不会执行 )。\n<code></code>`javascript\nimport React, { Component } from &#39;react&#39;;\nimport { connect } from &#39;react-redux&#39;;</p>\n\n<p>class Children extends Component {\nconstructor(props) {\n  super(props);\n  this.state = {\n    toDoList: this.props.toDoList\n  }\n}\ncomponentWillReceiveProps(nextProps) {\n  console.log(&#39;children component will receive props&#39;,\n  this.props.toDoList === nextProps.toDoList);\n  this.setState({\n    toDoList: nextProps.toDoList\n  })\n}\nrender() {\n  console.log(&#39;children component render&#39;, this.props);\n  return (\n    &lt;div &gt;\n      &lt;h3&gt; Children &lt;/h3&gt;\n      &lt;div&gt;\n        {\n          this.state.toDoList.map(\n            (item, index) =&gt; (\n              &lt;span key={index}&gt;{ item }&lt;/span&gt;\n            )\n          )\n        }\n      &lt;/div&gt;\n    &lt;/div&gt;\n  );\n}\n}</p>\n\n<p>export default connect(\nstate =&gt; {\n  console.log(&#39;state from redux&#39;, state);\n  return {\n    toDoList: state.toDoList\n  }\n}\n)(Children);</p>\n\n<p><code></code>` <br/>&lt;div  align=&quot;center&quot;&gt;  <br/>  &lt;img src=&quot;../images/react-update/redux-update.png&quot; alt=&quot;redux-update&quot;&gt;\n&lt;/div&gt;</p>\n\n<h3>react + redux + reselect</h3>\n\n<p>当 <code>redux state</code> 改变，会执行所有的 <code>mapStateToProps</code>，执行 <code>createSelector</code> 中的 <code>state array</code>，这里面的值没有改变时，直接返回上次的值，如果更新，执行 <code>selector</code>， 然后 <code>redux</code> 会再进行一次检查。\n<code>javascript\nexport const getToDoList = createSelector(\n  [state =&gt; {\n    console.log(&#39;in state&#39;);\n    return state.toDoList;\n  }],\n  toDoList =&gt; {\n    console.log(&#39;in selector&#39;);\n    return toDoList;\n  }\n)\n// in Children component\nexport default connect(\n  state =&gt; {\n    console.log(&#39;state from redux&#39;, state);\n    let toDoList = getToDoList(state);\n    console.log(&#39;from selector&#39;, toDoList);\n    return {\n      toDoList\n    }\n  }\n)(Children);\n</code>\n&lt;div  align=&quot;center&quot;&gt;  <br/>  &lt;img src=&quot;../images/react-update/selector-update.png&quot; alt=&quot;selector-update&quot;&gt;\n&lt;/div&gt;</p>\n\n<p><strong>* P.S.I 一句话总结：<code>react</code> 中所有的检查均为浅检查，即仅检查指针是否改变（标准的 js 检查） </strong>*</p>\n\n<h2>Vue 相关总结</h2>\n\n<p>vue 采用 <code>observer</code> (观察者模式) 的方式决定是否渲染组件。\n1. 遍历 <code>data</code> 和 <code>vuex state</code> 并为每个定义好的值添加 <code>observer</code> (即使是嵌套也添加)。\n2. 当有 <code>observer</code> 的值改变时，重新渲染组件。\n3. 执行到 <code>computed</code> 和 <code>getters</code> 的时候，用到哪个变量(即执行某个变量的 <code>get()</code> )，就往他的 <code>observer</code> 中注册事件，当此变量变化时，再重新执行 <code>computed</code> 和 <code>getters</code>(此过程为根据现象推测)。\n4. vue 组件默认为类似 <code>PureComponent</code>。</p>","date":"2018-01-29","fileDir":"/Users/sena/Documents/project/Senasiko.github.io/posts/2018/01/29/react-update","postName":"react-update","postUrl":"/posts/2018/01/29/react-update"},{"config":{"layout":"post","title":"react-native介绍","description":"react-native介绍","share":true,"tags":["react-native"],"date":"2017-08-11"},"content":"<h2>reanct-native 介绍</h2>\n\n<h3>简介</h3>\n\n<p>React Native 就是用 JavaScript 代码写 android 和 ios 原生应用。即 learn once, write anywhere</p>\n\n<h3>技术栈</h3>\n\n<ol><li>js、html、css</li><li><a href=\"https://wohugb.gitbooks.io/ecmascript-6/content/docs/intro.html\">ECMAScript6</a></li><li><a href=\"https://discountry.github.io/react/tutorial/tutorial.html\">React 框架</a></li><li><a href=\"http://cn.redux.js.org\">redux 状态管理器</a></li><li><a href=\"http://reactnative.cn/docs/0.47/getting-started.html\">react-native</a></li><li>对 android 和 ios 开发的简单了解</li></ol>\n\n<h3>开发环境</h3>\n\n<p>参照 <a href=\"http://reactnative.cn/docs/0.47/getting-started.html\">react-native 搭建开发环境</a>          <br/>1. 下载 python2、node 并安装 <strong>(不能是python3)</strong>      <br/>2. 通过 npm 安装 yarn，之后可以用 <code>yarn add</code> 代替 <code>npm install --save</code>    <br/>3. 安装 React Native 的命令行工具 <code>yarn add react-native-cli</code>      <br/>4. 安装 android studio 并配置 <strong>(android studio 的配置必须严格按照 RN 官网来，没有让勾的不能勾，否则无法运行)</strong>      <br/>5. 配置 android 环境变量    <br/>6. <code>react-native init projectname</code> 初始化项目</p>\n\n<h3>开发准备</h3>\n\n<ol><li>编辑器</li><li>模拟器。可以用 android studio 自带的，也可以用 <a href=\"https://www.genymotion.com/account/login/\">genymotion</a></li><li>使用 <code>react-native run-android</code> 或者 <code>react-native run-ios</code>命令，用于打包生成安装包并在模拟器上运行<ul><li>通过 <code>adb devices</code> 查看目前有几个模拟器，同时只能有一个存在</li><li>cannot delete path ... 错误可通过 <code>cd android &amp;&amp; gradlew.bat clean</code> 解决</li></ul></li><li>使用 <code>react-native log-android</code> 打印日志，输出程序中的 <code>console.log()</code> <strong>( <code>console.log()</code> 会严重影响性能 )</strong>\n&lt;div  align=&quot;center&quot;&gt;  <br/>&lt;img src=&quot;../images/log-android.png&quot; alt=&quot;log-android效果图&quot;&gt;\n&lt;p&gt;log-android 效果图&lt;/p&gt;\n&lt;/div&gt;      </li><li><code>npm install -g react-devtools</code> 安装调试工具，<code>react-devtools</code> 运行该工具，用于查看内部的 dom 结构\n&lt;div  align=&quot;center&quot;&gt;  <br/>&lt;img src=&quot;../images/react-devtools.png&quot; alt=&quot;react-devtools&quot; style=&quot;width: 700px&quot;&gt;\n&lt;p&gt;react-devtools&lt;/p&gt;\n&lt;/div&gt;      </li><li>模拟器按 <code>Ctrl + m</code> 或者摇晃真机呼出开发者选项，可进行设置\n&lt;div  align=&quot;center&quot;&gt;  <br/>&lt;img src=&quot;../images/kaifazhecaidan.png&quot; alt=&quot;react-devtools&quot; style=&quot;width: 300px&quot;&gt;\n&lt;p&gt;开发者菜单&lt;/p&gt;\n&lt;/div&gt;      <ul><li><code>reload</code> 重新加载，相当于F5</li><li><code>debug js remotely</code>，相当于f12，可以断点调试</li><li><code>live reload</code>，相当于实时F5</li><li><code>hot reloading</code>，热加载，相当于局部刷新，会保留之前的状态</li><li><code>toggle inspector</code>，相当于 &lt;img src=&quot;../images/toggle-inspector.png&quot; alt=&quot;&quot;&gt;</li><li><code>show perf monitor</code> 开启硬件信息，如fps等</li></ul></li><li>关于使用 chrom 调试程序。\n在开发者选项中点击 <code>debug js romotely</code> 即可在 chrome 中开启控制台。相关使用方法可以参照<a href=\"https://github.com/crazycodeboy/RNStudyNotes/blob/master/React%20Native%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7%E4%B8%8E%E5%BF%83%E5%BE%97/React%20Native%E8%B0%83%E8%AF%95%E6%8A%80%E5%B7%A7%E4%B8%8E%E5%BF%83%E5%BE%97.md#如何通过-chrome调试react-native程序\">如何通过 Chrome 调试 React Native 程序</a><ul><li>开启控制台之后 reload 可能会导致 app 闪退，重新开启 app 即可</li><li>开启控制台会导致 <code>log-android</code> 查看 log 的方法失效，<code>console.log()</code> 会输出到控制台的 console 中</li></ul></li></ol>\n\n<p>可以开始敲代码了~</p>","date":"2017-08-11","fileDir":"/Users/sena/Documents/project/Senasiko.github.io/posts/2017/08/11/react-native-introduction","postName":"react-native-introduction","postUrl":"/posts/2017/08/11/react-native-introduction"},{"config":{"layout":"post","title":"react-native开发过程中遇到的问题","description":"react-native开发过程中遇到的问题记录","share":true,"tags":["react-native"],"date":"2017-08-04"},"content":"<h2>使用 <code>react-native-video</code> ，安装app报错</h2>\n\n<h3>原因</h3>\n\n<p>版本问题：<code>&quot;react-native-video&quot;: &quot;^1.2.0&quot;,</code> 和 <code>&quot;react-native&quot;: &quot;^0.47.0&quot;,</code></p>\n\n<h3>解决办法</h3>\n\n<p>参照 <a href=\"https://github.com/react-native-community/react-native-video/pull/718/files\">这里</a></p>\n\n<h2>使用reducer组件不更新</h2>\n\n<h3>原因</h3>\n\n<p>reducer 中 newState 不能指向 state，指向的话会认为没有变化。</p>\n\n<h3>解决办法</h3>\n\n<p><code>newState = {...state}</code>\nps: 在 <code>switch case</code> 中 <code>default</code> 必须返回原 state，即\n<code>\nswitch(action.type){\n...\ndefault: return state;break;\n}\n</code></p>\n\n<h2>react-native run-android 时报 cannot delete path ... 错误</h2>\n\n<h3>解决办法</h3>\n\n<p><code>cd android &amp;&amp; gradlew.bat clean</code></p>","date":"2017-08-04","fileDir":"/Users/sena/Documents/project/Senasiko.github.io/posts/2017/08/04/react-native-question","postName":"react-native-question","postUrl":"/posts/2017/08/04/react-native-question"}]);
    }
  });

  var userMsg = window.vueCom.userMsg('#userMsg', {
      data: {
        name: 'sena',
        img: '/static/img/user.png',
        birthday: ''
      }
    })

  var pagination = window.reactCom.pagination('#pagination', {
    defaultCurrent: 1,
    total: 8,
    pageSize: 3
  })
});</script></head><body><div id="userMsg"></div><div class="right-container"><div id="app"></div><div id="pagination"></div></div><script>document.body.innerHeight = window.innerHeight;
document.body.innerWidth = window.innerWidth;</script></body></html>