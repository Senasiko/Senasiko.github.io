<html><head><title>标题</title><link href="/Senasiko.github.io/static/css/app.css" rel="stylesheet"/><link href="/Senasiko.github.io/static/css/react.main.css" rel="stylesheet"/><link href="/Senasiko.github.io/static/css/markdown.css" rel="stylesheet"/><link href="/Senasiko.github.io/static/css/main.css" rel="stylesheet"/><style>#userMsgMask {
  /*-webkit-mask-image: url('/Senasiko.github.io/static/img/mask.png');*/
}</style><script>window.rootPath = '/Senasiko.github.io';</script><script src="/Senasiko.github.io/static/js/jquery-3.3.1.min.js"></script><script src="/Senasiko.github.io/static/js/router.js"></script><script src="/Senasiko.github.io/static/js/react.main.js"></script><script src="/Senasiko.github.io/static/js/vue.manifest.js"></script><script src="/Senasiko.github.io/static/js/vue.vendor.js"></script><script src="/Senasiko.github.io/static/js/vue.app.js"></script><script type="text/javascript">$(document).ready(function() {
  var list = window.vueCom.postList('#app', {
    mounted: function() {
      list.getRef().init([{"config":{"title":"7月追番汇总","layout":"page","description":"7月追番汇总","image":" ","feature":"2017-07-anime-feature.png","share":true,"date":"2017-07-29"},"content":"<h3>日曜日</h3>\n<ul>\n<li>骑士与魔法</li>\n<li>舞动青春</li>\n</ul>\n<h3>月曜日</h3>\n<ul>\n<li>Princess Principal *</li>\n<li>天使的3p</li>\n</ul>\n<h3>火曜日</h3>\n<ul>\n<li>异世界食堂</li>\n<li>单蠢女孩</li>\n<li>徒然喜欢你</li>\n<li>带着手机闯荡异世界 *</li>\n<li>new game</li>\n</ul>\n<h3>水曜日</h3>\n<ul>\n<li>捏造陷阱</li>\n</ul>\n<h3>木曜日</h3>\n<ul>\n<li>欢迎来到实力至上主义教室</li>\n</ul>\n<h3>金曜日</h3>\n<ul>\n<li>来自深渊 *</li>\n</ul>\n<h3>土曜日</h3>\n<ul>\n<li>FA</li>\n<li>re:creators</li>\n</ul>\n","date":"2017-07-29","postName":"anime","postUrl":"/posts/2017/07/29/anime","postAbsUrl":"/Senasiko.github.io/posts/2017/07/29/anime"},{"config":{"layout":"post","title":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","description":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","tags":["react-native","redux","navigation"],"share":true,"date":"2017-07-28"},"content":"<h3>解决过程</h3>\n<ol>\n<li>\n<p>去掉navigation<br>\n成功传递state和action</p>\n</li>\n<li>\n<p>添加combineReducers，只添加视图的reducer，看是否是combineReducers的问题</p>\n</li>\n</ol>\n<pre><code class=\"language-js\">import Home from './modules/home/views/Home'\n// 合并所有的reducer\nconst reducer = combineReducers({\n    home: home.reducer\n});\n// 连接redux和组件\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n// 生成store\nconst store = applyMiddleware(thunk)(createStore)(reducer);\n</code></pre>\n<p>成功传递state<br>\n3. 添加navigation的reducer，看是否是这个的问题</p>\n<pre><code class=\"language-js\">//注册路由reducer\nexport const stackReducer = (state,action) =&gt; {\n    const newState = StackRouter.router.getStateForAction(action, state);\n    return newState || state;\n};\n\n// 合并所有的reducer\nconst reducer = combineReducers({\n    router: stackReducer,\n    home: home.reducer\n});\n</code></pre>\n<p>没问题，router的数据也有取到<br>\n4. 添加bindActionCreators</p>\n<pre><code class=\"language-js\">// 合并所有的action到props\nconst mapActionToProps = (dispatch) =&gt; {\n    return {\n        homeaction: bindActionCreators(home.actions, dispatch)\n    }\n};\n</code></pre>\n<p>木有问题，action成功传递到，正常使用<br>\n5. 把connect()(Home)改为connect()(StackRouter)，看是否是路由视图影响</p>\n<pre><code class=\"language-js\">//建立路由组件\nclass RouterApp extends Component{\n    constructor(props){\n        super(props)\n    }\n    render(){\n        return(\n            &lt;StackRouter/&gt;\n        )\n    }\n}\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n</code></pre>\n<p>state和action都没有传递，确定是路由组件的问题<br>\n6. 修改路由组件，查找失败原因<br>\n7. 找了一天半找不到原因，去提问吧_(:зゝ∠)_<br>\n解决问题 <a href=\"https://stackoverflow.com/questions/45396088/redux-state-dont-send-when-use-react-navigation\">stackoverflow</a></p>\n<h3>原因解释</h3>\n<p>该问题是因为navigation组件的加入导致store的数据无法向下传递。在navigation加入之前仅需把根组件和store connect就好，但是加入之后就不行了。<br>\n解决办法有两个：</p>\n<ol>\n<li>把store加入screenProps</li>\n</ol>\n<pre><code class=\"language-js\">&lt;StackRouter navigation={addNavigationHelpers({\n                 state: this.props.router\n             })} screenProps = {this.props}/&gt;       \n</code></pre>\n<p>但是这种办法会把整个state都传递给所有的子组件<br>\n2) 给每个组件connect<br>\n在子组件的view.js里导出connect后的组件</p>\n<pre><code class=\"language-js\">\nexport default connect(\n    (state) =&gt; ({\n        home: state.home\n    }),\n    (dispatch) =&gt; ({\n        actions: bindActionCreators(actions, dispatch)\n    })\n)(Home);\n</code></pre>\n<p><strong>ps: redux 中 connect之后的也是一个组件，这个没理解好导致问题没有很快解决</strong></p>\n","date":"2017-07-28","postName":"react-navigation","postUrl":"/posts/2017/07/28/react-navigation","postAbsUrl":"/Senasiko.github.io/posts/2017/07/28/react-navigation"},{"config":{"layout":"post","title":"react-native起步易错点记录","description":"react-native起步易错点记录","share":true,"tags":["react-native"],"date":"2017-07-26"},"content":"<h4>按照 <a href=\"http://reactnative.cn/docs/0.46/getting-started.html\">react-native中文文档</a> 起步</h4>\n<h2>样式</h2>\n<ul>\n<li>建议使用 <code>StyleSheet.create</code> 来集中定义组件的样式</li>\n</ul>\n<pre><code class=\"language-js\">const styles = StyleSheet.create({\n  bigblue: {\n    color: 'blue',\n    fontWeight: 'bold',\n    fontSize: 30,\n  },\n  red: {\n    color: 'red',\n  },\n});\n</code></pre>\n<h2>标签</h2>\n<ul>\n<li><code>&lt;FlastList&gt;</code> 中 <code>renderItem</code> 属性函数内部 <code>this</code> 指向 <code>window</code> ，所以要使用 this 请在 return 里使用</li>\n<li><code>&lt;FlastList&gt;</code> 的父元素<strong>必须设置 <code>{flex: 1}</code></strong> <strong>必须设置 <code>{flex: 1}</code></strong> <strong>必须设置 <code>{flex: 1}</code></strong></li>\n</ul>\n<h2>资源</h2>\n<ul>\n<li>require中的图片名字必须是一个静态字符串（不能使用变量！因为require是在编译时期执行，而非运行时期执行！）。</li>\n<li>如果你需要动态缩放图片（例如，通过flex），你可能必须手动在style属性设置{ width: undefined, height: undefined }。</li>\n<li>视频必须指定尺寸而不能使用flex样式。</li>\n<li>边框圆角样式目前在iOS的图片组件上还不支持。</li>\n</ul>\n<h2>杂记</h2>\n<ul>\n<li>在iOS上使用http链接的图片地址可能不会显示，参见<a href=\"https://segmentfault.com/a/1190000002933776\">这篇说明修改</a>。</li>\n<li>可以使用应用内的开发者菜单中的“FPS Monitor”工具来监控应用的帧率。</li>\n<li>android studio sdk配置必须6.0</li>\n<li>react 中 条件渲染可以这样写 <code>{isTrue &amp;&amp; &lt;div&gt;&lt;/div&gt;}</code></li>\n<li>react 给子元素传组件 <code>&lt;Child div={&lt;div /&gt;}/&gt;</code></li>\n</ul>\n<h2>常用网站</h2>\n<ul>\n<li><a href=\"http://www.jianshu.com/p/2f575cc35780\">react-navigation使用技巧</a></li>\n</ul>\n","date":"2017-07-26","postName":"react-native","postUrl":"/posts/2017/07/26/react-native","postAbsUrl":"/Senasiko.github.io/posts/2017/07/26/react-native"}]);
    }
  });
  var pagination = window.reactCom.pagination('#pagination', {
    defaultCurrent: 2,
    total: 8,
    pageSize: 3
  })
});</script></head><body><div id="loading"><i class="anticon anticon-spin anticon-loading"></i></div><div id="userMsgMask"><div id="userMsg"></div><script type="text/javascript">$(document).ready(function () {
  $('#loading').hide();
  var userMsg = window.vueCom.userMsg('#userMsg', {
    data: {
      img: '/Senasiko.github.io/static/img/user.png',
      msgs: [{"icon":"","value":"sena","link":"/Senasiko.github.io"},{"icon":"anticon anticon-calendar","value":"1996-01-27"},{"value":"github","icon":"anticon anticon-github","link":"https://github.com/Senasiko","newTag":true},{"value":"senasiko@gmail.com","icon":"anticon anticon-mail"},{"icon":"anticon anticon-weibo","link":"https://www.weibo.com","newTag":true}]
    }
  })
});</script></div><div class="right-container"><div id="app"></div><div id="pagination"></div></div><script>document.body.innerHeight = window.innerHeight;
document.body.innerWidth = window.innerWidth;</script></body></html>