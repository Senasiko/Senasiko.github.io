<html><head><title>标题</title><link href="/static/css/app.css" rel="stylesheet"/><link href="/static/css/react.main.css" rel="stylesheet"/><link href="/static/css/markdown.css" rel="stylesheet"/><link href="/static/css/main.css" rel="stylesheet"/><script src="/static/js/jquery-3.3.1.min.js"></script><script src="/static/js/router.js"></script><script src="/static/js/react.main.js"></script><script src="/static/js/vue.manifest.js"></script><script src="/static/js/vue.vendor.js"></script><script src="/static/js/vue.app.js"></script></head><body><div id="userMsg"></div><script type="text/javascript">$(document).ready(function () {
  var userMsg = window.vueCom.userMsg('#userMsg', {
    data: {
      name: 'sena',
      img: '/static/img/user.png',
      birthday: ''
    }
  })
});</script><div id="tagList"></div><script type="text/javascript">$(document).ready(function () {
  var tagPosts = {"react-native":[{"config":{"layout":"post","title":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","description":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","tags":["react-native","redux","navigation"],"share":true,"date":"2017-07-28"},"content":"<h3>解决过程</h3>\n\n<ol><li><p>去掉navigation\n成功传递state和action</p></li><li><p>添加combineReducers，只添加视图的reducer，看是否是combineReducers的问题\n<code>js\nimport Home from &#39;./modules/home/views/Home&#39;\n// 合并所有的reducer\nconst reducer = combineReducers({\nhome: home.reducer\n});\n// 连接redux和组件\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n// 生成store\nconst store = applyMiddleware(thunk)(createStore)(reducer);\n</code>\n成功传递state</p></li><li><p>添加navigation的reducer，看是否是这个的问题\n<code></code>`js\n//注册路由reducer\nexport const stackReducer = (state,action) =&gt; {\n    const newState = StackRouter.router.getStateForAction(action, state);\n    return newState || state;\n};</p><p>// 合并所有的reducer\nconst reducer = combineReducers({\n    router: stackReducer,\n    home: home.reducer\n});\n<code></code>`\n没问题，router的数据也有取到</p></li><li>添加bindActionCreators\n<code>js\n// 合并所有的action到props\nconst mapActionToProps = (dispatch) =&gt; {\nreturn {\n    homeaction: bindActionCreators(home.actions, dispatch)\n}\n};\n</code>\n木有问题，action成功传递到，正常使用</li><li>把connect()(Home)改为connect()(StackRouter)，看是否是路由视图影响\n<code>js\n//建立路由组件\nclass RouterApp extends Component{\nconstructor(props){\n    super(props)\n}\nrender(){\n    return(\n        &lt;StackRouter/&gt;\n    )\n}\n}\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n</code>\nstate和action都没有传递，确定是路由组件的问题</li><li>修改路由组件，查找失败原因</li><li>找了一天半找不到原因，去提问吧<em>(:зゝ∠)</em>\n解决问题 <a href=\"https://stackoverflow.com/questions/45396088/redux-state-dont-send-when-use-react-navigation\">stackoverflow</a></li></ol>\n\n<h3>原因解释</h3>\n\n<p>该问题是因为navigation组件的加入导致store的数据无法向下传递。在navigation加入之前仅需把根组件和store connect就好，但是加入之后就不行了。\n解决办法有两个：\n1) 把store加入screenProps</p>\n\n<p><code>js\n&lt;StackRouter navigation={addNavigationHelpers({\n                 state: this.props.router\n             })} screenProps = {this.props}/&gt;\n</code></p>\n\n<p>但是这种办法会把整个state都传递给所有的子组件\n2) 给每个组件connect\n在子组件的view.js里导出connect后的组件\n<code></code>`js</p>\n\n<p>export default connect(\n    (state) =&gt; ({\n        home: state.home\n    }),\n    (dispatch) =&gt; ({\n        actions: bindActionCreators(actions, dispatch)\n    })\n)(Home);\n<code></code>`\n<strong>ps: redux 中 connect之后的也是一个组件，这个没理解好导致问题没有很快解决</strong></p>","date":"2017-07-28","postName":"react-navigation","postUrl":"/posts/2017/07/28/react-navigation"}],"redux":[{"config":{"layout":"post","title":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","description":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","tags":["react-native","redux","navigation"],"share":true,"date":"2017-07-28"},"content":"<h3>解决过程</h3>\n\n<ol><li><p>去掉navigation\n成功传递state和action</p></li><li><p>添加combineReducers，只添加视图的reducer，看是否是combineReducers的问题\n<code>js\nimport Home from &#39;./modules/home/views/Home&#39;\n// 合并所有的reducer\nconst reducer = combineReducers({\nhome: home.reducer\n});\n// 连接redux和组件\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n// 生成store\nconst store = applyMiddleware(thunk)(createStore)(reducer);\n</code>\n成功传递state</p></li><li><p>添加navigation的reducer，看是否是这个的问题\n<code></code>`js\n//注册路由reducer\nexport const stackReducer = (state,action) =&gt; {\n    const newState = StackRouter.router.getStateForAction(action, state);\n    return newState || state;\n};</p><p>// 合并所有的reducer\nconst reducer = combineReducers({\n    router: stackReducer,\n    home: home.reducer\n});\n<code></code>`\n没问题，router的数据也有取到</p></li><li>添加bindActionCreators\n<code>js\n// 合并所有的action到props\nconst mapActionToProps = (dispatch) =&gt; {\nreturn {\n    homeaction: bindActionCreators(home.actions, dispatch)\n}\n};\n</code>\n木有问题，action成功传递到，正常使用</li><li>把connect()(Home)改为connect()(StackRouter)，看是否是路由视图影响\n<code>js\n//建立路由组件\nclass RouterApp extends Component{\nconstructor(props){\n    super(props)\n}\nrender(){\n    return(\n        &lt;StackRouter/&gt;\n    )\n}\n}\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n</code>\nstate和action都没有传递，确定是路由组件的问题</li><li>修改路由组件，查找失败原因</li><li>找了一天半找不到原因，去提问吧<em>(:зゝ∠)</em>\n解决问题 <a href=\"https://stackoverflow.com/questions/45396088/redux-state-dont-send-when-use-react-navigation\">stackoverflow</a></li></ol>\n\n<h3>原因解释</h3>\n\n<p>该问题是因为navigation组件的加入导致store的数据无法向下传递。在navigation加入之前仅需把根组件和store connect就好，但是加入之后就不行了。\n解决办法有两个：\n1) 把store加入screenProps</p>\n\n<p><code>js\n&lt;StackRouter navigation={addNavigationHelpers({\n                 state: this.props.router\n             })} screenProps = {this.props}/&gt;\n</code></p>\n\n<p>但是这种办法会把整个state都传递给所有的子组件\n2) 给每个组件connect\n在子组件的view.js里导出connect后的组件\n<code></code>`js</p>\n\n<p>export default connect(\n    (state) =&gt; ({\n        home: state.home\n    }),\n    (dispatch) =&gt; ({\n        actions: bindActionCreators(actions, dispatch)\n    })\n)(Home);\n<code></code>`\n<strong>ps: redux 中 connect之后的也是一个组件，这个没理解好导致问题没有很快解决</strong></p>","date":"2017-07-28","postName":"react-navigation","postUrl":"/posts/2017/07/28/react-navigation"}],"navigation":[{"config":{"layout":"post","title":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","description":"react-navigation 结合 redux 使用之后 state 和 action 无法传递","tags":["react-native","redux","navigation"],"share":true,"date":"2017-07-28"},"content":"<h3>解决过程</h3>\n\n<ol><li><p>去掉navigation\n成功传递state和action</p></li><li><p>添加combineReducers，只添加视图的reducer，看是否是combineReducers的问题\n<code>js\nimport Home from &#39;./modules/home/views/Home&#39;\n// 合并所有的reducer\nconst reducer = combineReducers({\nhome: home.reducer\n});\n// 连接redux和组件\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n// 生成store\nconst store = applyMiddleware(thunk)(createStore)(reducer);\n</code>\n成功传递state</p></li><li><p>添加navigation的reducer，看是否是这个的问题\n<code></code>`js\n//注册路由reducer\nexport const stackReducer = (state,action) =&gt; {\n    const newState = StackRouter.router.getStateForAction(action, state);\n    return newState || state;\n};</p><p>// 合并所有的reducer\nconst reducer = combineReducers({\n    router: stackReducer,\n    home: home.reducer\n});\n<code></code>`\n没问题，router的数据也有取到</p></li><li>添加bindActionCreators\n<code>js\n// 合并所有的action到props\nconst mapActionToProps = (dispatch) =&gt; {\nreturn {\n    homeaction: bindActionCreators(home.actions, dispatch)\n}\n};\n</code>\n木有问题，action成功传递到，正常使用</li><li>把connect()(Home)改为connect()(StackRouter)，看是否是路由视图影响\n<code>js\n//建立路由组件\nclass RouterApp extends Component{\nconstructor(props){\n    super(props)\n}\nrender(){\n    return(\n        &lt;StackRouter/&gt;\n    )\n}\n}\nconst StoreApp = connect(mapStateToProps, mapActionToProps)(Home);\n</code>\nstate和action都没有传递，确定是路由组件的问题</li><li>修改路由组件，查找失败原因</li><li>找了一天半找不到原因，去提问吧<em>(:зゝ∠)</em>\n解决问题 <a href=\"https://stackoverflow.com/questions/45396088/redux-state-dont-send-when-use-react-navigation\">stackoverflow</a></li></ol>\n\n<h3>原因解释</h3>\n\n<p>该问题是因为navigation组件的加入导致store的数据无法向下传递。在navigation加入之前仅需把根组件和store connect就好，但是加入之后就不行了。\n解决办法有两个：\n1) 把store加入screenProps</p>\n\n<p><code>js\n&lt;StackRouter navigation={addNavigationHelpers({\n                 state: this.props.router\n             })} screenProps = {this.props}/&gt;\n</code></p>\n\n<p>但是这种办法会把整个state都传递给所有的子组件\n2) 给每个组件connect\n在子组件的view.js里导出connect后的组件\n<code></code>`js</p>\n\n<p>export default connect(\n    (state) =&gt; ({\n        home: state.home\n    }),\n    (dispatch) =&gt; ({\n        actions: bindActionCreators(actions, dispatch)\n    })\n)(Home);\n<code></code>`\n<strong>ps: redux 中 connect之后的也是一个组件，这个没理解好导致问题没有很快解决</strong></p>","date":"2017-07-28","postName":"react-navigation","postUrl":"/posts/2017/07/28/react-navigation"}]};
  var tagPostsDom = window.vueCom.tagPosts('#tagList', {
    data: tagPosts
  });
});</script><script>document.body.innerHeight = window.innerHeight;
document.body.innerWidth = window.innerWidth;</script></body></html>